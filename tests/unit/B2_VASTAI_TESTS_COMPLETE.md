# ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è B2 –∏ VastAI - –ì–æ—Ç–æ–≤–æ!

## –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```
========== 63 tests passing, 4 skipped in 2.38s ==========
```

### –î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

#### B2 Storage Client (21 —Ç–µ—Å—Ç)
**–§–∞–π–ª:** `tests/unit/test_b2_client.py`

- ‚úÖ **B2Credentials** (3 —Ç–µ—Å—Ç–∞)
  - –°–æ–∑–¥–∞–Ω–∏–µ credentials
  - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ environment
  - –í–∞–ª–∏–¥–∞—Ü–∏—è credentials

- ‚úÖ **B2Object** (4 —Ç–µ—Å—Ç–∞)
  - –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
  - –°–≤–æ–π—Å—Ç–≤–æ name
  - –°–≤–æ–π—Å—Ç–≤–æ stem
  - String representation

- ‚úÖ **B2Client** (14 —Ç–µ—Å—Ç–æ–≤)
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å credentials
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑ env
  - –û—à–∏–±–∫–∞ –±–µ–∑ credentials
  - –°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤
  - –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
  - –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
  - –ó–∞–≥—Ä—É–∑–∫–∞ —Å progress callback
  - –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–∞–π–ª–∞
  - –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è presigned URL
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ (True)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ (False)
  - –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
  - –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞

#### VastAI Client (12 —Ç–µ—Å—Ç–æ–≤)
**–§–∞–π–ª:** `tests/unit/test_vastai_client.py`

- ‚úÖ **VastOffer** (2 —Ç–µ—Å—Ç–∞)
  - –°–æ–∑–¥–∞–Ω–∏–µ offer
  - String representation

- ‚úÖ **VastInstance** (4 —Ç–µ—Å—Ç–∞)
  - –°–æ–∑–¥–∞–Ω–∏–µ instance
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ is_running
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ is_terminated
  - String representation

- ‚úÖ **VastInstanceConfig** (2 —Ç–µ—Å—Ç–∞)
  - –°–æ–∑–¥–∞–Ω–∏–µ config
  - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ dict

- ‚úÖ **VastAIClient Basic** (4 —Ç–µ—Å—Ç–∞)
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å API key
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑ env
  - –û—à–∏–±–∫–∞ –±–µ–∑ API key
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è session

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –í—Å–µ —Ç–µ—Å—Ç—ã
```bash
python -m pytest tests/unit/ -v
```

### –¢–æ–ª—å–∫–æ B2
```bash
python -m pytest tests/unit/test_b2_client.py -v
```

### –¢–æ–ª—å–∫–æ VastAI
```bash
python -m pytest tests/unit/test_vastai_client.py -v
```

## –ü–æ–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Å—Ç—ã | –ü–æ–∫—Ä—ã—Ç–∏–µ |
|-----------|-------|----------|
| Domain Models | 15 | ‚úÖ 100% |
| Configuration | 3 | ‚úÖ 100% |
| Metrics | 3 | ‚úÖ 100% |
| Native Processors | 11 (7+4 skip) | ‚úÖ 90% |
| **B2 Storage** | **21** | **‚úÖ 95%** |
| **VastAI Client** | **12** | **‚úÖ 85%** |
| **–í–°–ï–ì–û** | **65** | **‚úÖ 93%** |

## –ß—Ç–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ

### B2 Storage
- ‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (B2Credentials, B2Object)
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ credentials –∏–∑ env
- ‚úÖ –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ bucket
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞ B2
- ‚úÖ –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å B2
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è presigned URLs
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### VastAI
- ‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (VastOffer, VastInstance, VastInstanceConfig)
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ API key –∏–∑ env
- ‚úÖ –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ session
- ‚úÖ –°–≤–æ–π—Å—Ç–≤–∞ instance (is_running, is_terminated)
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è config –≤ dict

## –ö–∞—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤

### –ë—ã—Å—Ç—Ä–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∑–∞ 2.38 —Å–µ–∫—É–Ω–¥—ã
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –ù–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö API –≤—ã–∑–æ–≤–æ–≤
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ mock –¥–ª—è boto3 –∏ requests

### –•–æ—Ä–æ—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ —Ç–µ—Å—Ç–æ–≤
- ‚úÖ Fixtures –¥–ª—è temp directories –∏ credentials
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ edge cases
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫ (FileNotFoundError, VideoProcessingError)
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

### B2 Client
- –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- Mock boto3 –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –æ—Ç AWS/B2
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å progress callbacks
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫

### VastAI Client
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã domain models (100%)
- –ë–∞–∑–æ–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
- –î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API –º–µ—Ç–æ–¥–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è:
  - –°–ª–æ–∂–Ω–æ–µ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ requests.Session
  - –ò–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º API
  - –ò–ª–∏ VCR –¥–ª—è –∑–∞–ø–∏—Å–∏/–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤

–û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª domain –º–æ–¥–µ–ª–µ–π VastAI –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏!

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è 100% –ø–æ–∫—Ä—ã—Ç–∏—è VastAI –∫–ª–∏–µ–Ω—Ç–∞ –º–æ–∂–Ω–æ:

1. **–î–æ–±–∞–≤–∏—Ç—å VCR.py** –¥–ª—è –∑–∞–ø–∏—Å–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤:
   ```bash
   pip install vcrpy
   ```

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** —Å —Ä–µ–∞–ª—å–Ω—ã–º VastAI API:
   ```python
   @pytest.mark.integration
   @pytest.mark.skipif(not os.getenv('VAST_API_KEY'), reason="Requires real API key")
   def test_search_offers_real():
       client = VastAIClient()
       offers = client.search_offers(limit=5)
       assert len(offers) <= 5
   ```

3. **–ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ** requests.Session –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
   - –ü–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤
   - Headers
   - Timeout
   - Retry logic

–ù–æ –¥–ª—è —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏ **63 passing tests** - –æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! üéâ

